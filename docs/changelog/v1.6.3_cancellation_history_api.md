# v1.6.3 - Cancellation History API

## Overview
This update introduces comprehensive API endpoints for users to track their subscription cancellation requests. It ensures transparency regarding request status and effective cancellation dates (end of billing period).

## New Features

### User Cancellation History
Users can now access their full history of cancellation requests, enabling "My Requests" UI features.

#### List Cancellations
*   **Endpoint**: `GET /api/user/cancellations`
*   **Description**: Retrieves a chronological list of all cancellation requests submitted by the user (newest first).
*   **Response**:
    ```json
    {
        "success": true,
        "message": "User cancellations",
        "data": [
            {
                "id": "uuid",
                "subscription_id": "uuid",
                "plan_name": "Pro Plan",
                "reason": "Too expensive",
                "status": "pending",
                "effective_date": "2026-02-01T00:00:00Z",
                "created_at": "2026-01-04T12:00:00Z"
            }
        ]
    }
    ```

#### Cancellation Detail
*   **Endpoint**: `GET /api/user/cancellations/:cancellationId`
*   **Description**: Retrieves detailed information for a specific cancellation request.
*   **Response**: Same structure as a single item from the list response.
*   **Errors**: Returns `404 Not Found` if the ID does not exist or belongs to another user.

## Logic Specifications
*   **Effective Date**: The `effective_date` returned is the **End of the Current Billing Period**. The user retains access until this date.
*   **Status Lifecycle**:
    *   `pending`: Request submitted, awaiting admin review (if applicable) or automatic processing.
    *   `approved`: Cancellation confirmed; access ends on `effective_date`.
    *   `rejected`: Request denied (e.g., if re-subscribed).

## Admin Improvements
*   **Plan Deletion**: Attempts to delete a Plan that has active/historical subscriptions now gracefully return `409 Conflict` with a clear message ("Cannot delete plan... archive instead"), preventing server-side errors.
