# Frontend Changelog: Persistent Chat References

## Version: v1.7.0
**Date:** 2026-01-05
**Feature:** Persistent Chat Note References

## Overview
Backend support for persistent note references has been implemented. The frontend needs to update its state management and UI to display these references when loading chat history.

## API Changes

### `GET /api/chatbot/v1/history/:sessionId`
The response for each message in the history array now includes a `references` field.

**Response Interface Update:**
```typescript
interface ChatMessage {
  id: string;
  role: "user" | "model";
  chat: string;
  created_at: string;
  citations?: Citation[]; // Existing RAG citations (Model messages)
  references?: ResolvedReference[]; // [NEW] User references (User messages)
}

interface ResolvedReference {
  note_id: string;
  title: string;
  resolved: boolean;
}
```

### `POST /api/chatbot/v1/send-chat`
The response for the SENT message (User part) now includes `references`.

**Response Interface Update:**
```typescript
interface SendChatResponse {
  chat_session_id: string;
  sent: {
    id: string;
    chat: string;
    role: "user";
    references: ResolvedReference[]; // [NEW] Confirmed saved references
  };
  reply: {
    // ... model reply details
  };
}
```

## Frontend Implementation Tasks

1.  **Update Types:** Add `references` field to your `ChatMessage` and `SendChatResponse` interfaces.
2.  **UI Update:**
    *   In the Chat Message component, check if `references` exists and has length > 0.
    *   If yes, render a "References" section (similar to how File Attachments or Citations are shown) below or above the user's message text.
    *   Display each reference as a chip or link (e.g., `ðŸ“„ [Note Title]`).
3.  **State Management:** Ensure that when `GetChatHistory` loads, these references are stored in the chat state so they persist across page refreshes.
