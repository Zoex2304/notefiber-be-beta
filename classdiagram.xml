<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36 Edg/142.0.0.0" version="28.2.9">
  <diagram name="Page-1" id="notefiber-chatbot-final">
    <mxGraphModel dx="1338" dy="1924" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="1200" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="title" value="&lt;font style=&quot;font-size: 25px;&quot;&gt;Notefiber - Chatbot AI Features&lt;/font&gt;" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;strokeWidth=5;" parent="1" vertex="1">
          <mxGeometry x="625" y="-180" width="350" height="30" as="geometry" />
        </mxCell>
        <mxCell id="view-entry" value="&lt;&lt;View Entry&gt;&gt;&#xa;app.tsx" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="230" y="-120" width="280" height="130" as="geometry" />
        </mxCell>
        <mxCell id="view-entry-attr" value="+ isChatOpen: boolean" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="view-entry" vertex="1">
          <mxGeometry y="40" width="280" height="26" as="geometry" />
        </mxCell>
        <mxCell id="view-entry-line" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" parent="view-entry" vertex="1">
          <mxGeometry y="66" width="280" height="8" as="geometry" />
        </mxCell>
        <mxCell id="view-entry-methods" value="+ handleOpenChat()&#xa;+ handleCloseChat()" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="view-entry" vertex="1">
          <mxGeometry y="74" width="280" height="56" as="geometry" />
        </mxCell>
        <mxCell id="view-main" value="&lt;&lt;View Component&gt;&gt;&#xa;ai-chat-dialog.tsx" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="230" y="65" width="280" height="190" as="geometry" />
        </mxCell>
        <mxCell id="view-main-attr" value="+ input: string&#xa;+ sessions: ChatSession[]&#xa;+ activeSessionId: UUID&#xa;+ isLoading: boolean&#xa;+ messages: ChatMessage[]" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="view-main" vertex="1">
          <mxGeometry y="40" width="280" height="80" as="geometry" />
        </mxCell>
        <mxCell id="view-main-line" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" parent="view-main" vertex="1">
          <mxGeometry y="120" width="280" height="8" as="geometry" />
        </mxCell>
        <mxCell id="view-main-methods" value="+ fetchData()&#xa;+ handleSessionClick()&#xa;+ handleSendMessage()&#xa;+ createNewSession()" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="view-main" vertex="1">
          <mxGeometry y="128" width="280" height="62" as="geometry" />
        </mxCell>
        <mxCell id="view-dto" value="&lt;&lt;DTO Frontend&gt;&gt;&#xa;chatbot.ts" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="230" y="360" width="280" height="90" as="geometry" />
        </mxCell>
        <mxCell id="view-dto-content" value="+ interface ChatSession&#xa;+ type ChatMessage&#xa;+ interface SendChatRequest" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="view-dto" vertex="1">
          <mxGeometry y="40" width="280" height="50" as="geometry" />
        </mxCell>
        <mxCell id="rel-view-entry-main" value="" style="endArrow=open;endFill=0;dashed=1;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="view-entry" target="view-main" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rel-view-entry-main-label" value="Dependency&#xa;(renders component)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#9933FF;" parent="rel-view-entry-main" vertex="1" connectable="0">
          <mxGeometry x="-0.2" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-view-controller" value="" style="endArrow=open;endFill=0;dashed=1;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=2;" parent="1" source="view-main" target="controller" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rel-view-controller-label" value="Dependency (HTTP)&#xa;(API calls)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#9933FF;fontStyle=1" parent="rel-view-controller" vertex="1" connectable="0">
          <mxGeometry x="-0.1" relative="1" as="geometry">
            <mxPoint y="-15" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="main" value="&lt;&lt;Entry Point&gt;&gt;&#xa;main.go" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="660" y="-120" width="280" height="140" as="geometry" />
        </mxCell>
        <mxCell id="main-attr" value="+ db: *pgxpool.Pool&#xa;+ repositories: []IRepository&#xa;+ services: []IService&#xa;+ controllers: []IController" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="main" vertex="1">
          <mxGeometry y="40" width="280" height="60" as="geometry" />
        </mxCell>
        <mxCell id="main-line" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" parent="main" vertex="1">
          <mxGeometry y="100" width="280" height="8" as="geometry" />
        </mxCell>
        <mxCell id="main-methods" value="+ main()&#xa;+ RegisterRoutes()" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="main" vertex="1">
          <mxGeometry y="108" width="280" height="32" as="geometry" />
        </mxCell>
        <mxCell id="controller" value="&lt;&lt;Interface&gt;&gt;&#xa;IChatbotController" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="660" y="80" width="280" height="180" as="geometry" />
        </mxCell>
        <mxCell id="controller-attr" value="- chatbotService: IChatbotService" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="controller" vertex="1">
          <mxGeometry y="40" width="280" height="26" as="geometry" />
        </mxCell>
        <mxCell id="controller-line" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" parent="controller" vertex="1">
          <mxGeometry y="66" width="280" height="8" as="geometry" />
        </mxCell>
        <mxCell id="controller-methods" value="+ RegisterRoutes(r fiber.Router)&#xa;+ CreateSession(ctx) error&#xa;+ GetAllSessions(ctx) error&#xa;+ GetChatHistory(ctx) error&#xa;+ SendChat(ctx) error&#xa;+ DeleteSession(ctx) error" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="controller" vertex="1">
          <mxGeometry y="74" width="280" height="106" as="geometry" />
        </mxCell>
        <mxCell id="dto" value="&lt;&lt;DTO&gt;&gt;&#xa;chatbot_dto.go" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="660" y="320" width="280" height="120" as="geometry" />
        </mxCell>
        <mxCell id="dto-content" value="+ CreateSessionResponse&#xa;+ GetAllSessionsResponse&#xa;+ GetChatHistoryResponse&#xa;+ SendChatRequest&#xa;+ SendChatResponse&#xa;+ DeleteSessionRequest" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="dto" vertex="1">
          <mxGeometry y="40" width="280" height="80" as="geometry" />
        </mxCell>
        <mxCell id="service" value="&lt;&lt;Interface&gt;&gt;&#xa;IChatbotService" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="1330.6" y="50" width="300" height="250" as="geometry" />
        </mxCell>
        <mxCell id="service-attr" value="- db: *pgxpool.Pool&#xa;- chatSessionRepository: IRepo&#xa;- chatMessageRepository: IRepo&#xa;- chatMessageRawRepository: IRepo&#xa;- noteEmbeddingRepository: IRepo" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="service" vertex="1">
          <mxGeometry y="40" width="300" height="80" as="geometry" />
        </mxCell>
        <mxCell id="service-line" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" parent="service" vertex="1">
          <mxGeometry y="120" width="300" height="8" as="geometry" />
        </mxCell>
        <mxCell id="service-methods" value="+ CreateSession(ctx) Response&#xa;+ GetAllSessions(ctx) []Response&#xa;+ GetChatHistory(ctx, id) []Response&#xa;+ SendChat(ctx, req) Response&#xa;+ DeleteSession(ctx, req) error" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="service" vertex="1">
          <mxGeometry y="128" width="300" height="122" as="geometry" />
        </mxCell>
        <mxCell id="repo-session" value="&lt;&lt;Interface&gt;&gt;&#xa;IChatSessionRepository" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="1520" y="420" width="240" height="140" as="geometry" />
        </mxCell>
        <mxCell id="repo-session-attr" value="- db: DatabaseQueryer" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="repo-session" vertex="1">
          <mxGeometry y="40" width="240" height="26" as="geometry" />
        </mxCell>
        <mxCell id="repo-session-line" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" parent="repo-session" vertex="1">
          <mxGeometry y="66" width="240" height="8" as="geometry" />
        </mxCell>
        <mxCell id="repo-session-methods" value="+ Create(ctx, session) error&#xa;+ GetAll(ctx) []Session&#xa;+ GetById(ctx, id) Session&#xa;+ Update(ctx, session) error&#xa;+ Delete(ctx, id) error" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="repo-session" vertex="1">
          <mxGeometry y="74" width="240" height="66" as="geometry" />
        </mxCell>
        <mxCell id="repo-message" value="&lt;&lt;Interface&gt;&gt;&#xa;IChatMessageRepository" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="1790.6" y="420" width="260" height="120" as="geometry" />
        </mxCell>
        <mxCell id="repo-message-attr" value="- db: DatabaseQueryer" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="repo-message" vertex="1">
          <mxGeometry y="40" width="260" height="26" as="geometry" />
        </mxCell>
        <mxCell id="repo-message-line" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" parent="repo-message" vertex="1">
          <mxGeometry y="66" width="260" height="8" as="geometry" />
        </mxCell>
        <mxCell id="repo-message-methods" value="+ Create(ctx, message) error&#xa;+ GetByChatSessionId(ctx, id) []Message&#xa;+ DeleteByChatSessionId(ctx, id) error" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="repo-message" vertex="1">
          <mxGeometry y="74" width="260" height="46" as="geometry" />
        </mxCell>
        <mxCell id="repo-raw" value="&lt;&lt;Interface&gt;&gt;&#xa;IChatMessageRawRepository" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="2080.6" y="420" width="270" height="120" as="geometry" />
        </mxCell>
        <mxCell id="repo-raw-attr" value="- db: DatabaseQueryer" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="repo-raw" vertex="1">
          <mxGeometry y="40" width="270" height="26" as="geometry" />
        </mxCell>
        <mxCell id="repo-raw-line" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" parent="repo-raw" vertex="1">
          <mxGeometry y="66" width="270" height="8" as="geometry" />
        </mxCell>
        <mxCell id="repo-raw-methods" value="+ Create(ctx, rawMessage) error&#xa;+ GetByChatSessionId(ctx, id) []RawMessage&#xa;+ DeleteByChatSessionId(ctx, id) error" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="repo-raw" vertex="1">
          <mxGeometry y="74" width="270" height="46" as="geometry" />
        </mxCell>
        <mxCell id="repo-embedding" value="&lt;&lt;Interface&gt;&gt;&#xa;INoteEmbeddingRepository" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="1830.6" y="80" width="270" height="140" as="geometry" />
        </mxCell>
        <mxCell id="repo-embedding-attr" value="- db: DatabaseQueryer" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="repo-embedding" vertex="1">
          <mxGeometry y="40" width="270" height="26" as="geometry" />
        </mxCell>
        <mxCell id="repo-embedding-line" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" parent="repo-embedding" vertex="1">
          <mxGeometry y="66" width="270" height="8" as="geometry" />
        </mxCell>
        <mxCell id="repo-embedding-methods" value="+ SearchSimilarity(ctx, vector) []Embedding&#xa;+ Create(ctx, embedding) error&#xa;+ DeleteByNoteID(ctx, id) error&#xa;+ DeleteByNotebookID(ctx, id) error" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="repo-embedding" vertex="1">
          <mxGeometry y="74" width="270" height="66" as="geometry" />
        </mxCell>
        <mxCell id="entity-session" value="&lt;&lt;Entity&gt;&gt;&#xa;chat_session_entity.go" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="1520" y="610" width="240" height="130" as="geometry" />
        </mxCell>
        <mxCell id="entity-session-content" value="+ Id: uuid.UUID&#xa;+ Title: string&#xa;+ CreatedAt: time.Time&#xa;+ UpdatedAt: *time.Time&#xa;+ DeletedAt: *time.Time&#xa;+ IsDeleted: bool" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="entity-session" vertex="1">
          <mxGeometry y="40" width="240" height="90" as="geometry" />
        </mxCell>
        <mxCell id="entity-message" value="&lt;&lt;Entity&gt;&gt;&#xa;chat_message_entity.go" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="1790.6" y="610" width="260" height="150" as="geometry" />
        </mxCell>
        <mxCell id="entity-message-content" value="+ Id: uuid.UUID&#xa;+ Chat: string&#xa;+ Role: string&#xa;+ ChatSessionId: uuid.UUID&#xa;+ CreatedAt: time.Time&#xa;+ UpdatedAt: *time.Time&#xa;+ DeletedAt: *time.Time&#xa;+ IsDeleted: bool" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="entity-message" vertex="1">
          <mxGeometry y="40" width="260" height="110" as="geometry" />
        </mxCell>
        <mxCell id="entity-raw" value="&lt;&lt;Entity&gt;&gt;&#xa;chat_message_raw_entity.go" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="2080.6" y="610" width="270" height="150" as="geometry" />
        </mxCell>
        <mxCell id="entity-raw-content" value="+ Id: uuid.UUID&#xa;+ Chat: string&#xa;+ Role: string&#xa;+ ChatSessionId: uuid.UUID&#xa;+ CreatedAt: time.Time&#xa;+ UpdatedAt: *time.Time&#xa;+ DeletedAt: *time.Time&#xa;+ IsDeleted: bool" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="entity-raw" vertex="1">
          <mxGeometry y="40" width="270" height="110" as="geometry" />
        </mxCell>
        <mxCell id="gemini-chat" value="&lt;&lt;External Service&gt;&gt;&#xa;gemini_chatbot.go" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="1710.6" y="-110" width="270" height="120" as="geometry" />
        </mxCell>
        <mxCell id="gemini-chat-attr" value="+ apiKey: string" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="gemini-chat" vertex="1">
          <mxGeometry y="40" width="270" height="26" as="geometry" />
        </mxCell>
        <mxCell id="gemini-chat-line" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" parent="gemini-chat" vertex="1">
          <mxGeometry y="66" width="270" height="8" as="geometry" />
        </mxCell>
        <mxCell id="gemini-chat-methods" value="+ GetGeminiResponse(ctx, key, history) string&#xa;+ DecideToUseRAG(ctx, key, history) bool" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="gemini-chat" vertex="1">
          <mxGeometry y="74" width="270" height="46" as="geometry" />
        </mxCell>
        <mxCell id="gemini-embed" value="&lt;&lt;External Service&gt;&gt;&#xa;gemini_embedding.go" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;fillColor=#e1d5e7;strokeColor=#9673a6;" parent="1" vertex="1">
          <mxGeometry x="1330.6" y="-120" width="300" height="110" as="geometry" />
        </mxCell>
        <mxCell id="gemini-embed-attr" value="+ apiKey: string" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="gemini-embed" vertex="1">
          <mxGeometry y="40" width="300" height="26" as="geometry" />
        </mxCell>
        <mxCell id="gemini-embed-line" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" parent="gemini-embed" vertex="1">
          <mxGeometry y="66" width="300" height="8" as="geometry" />
        </mxCell>
        <mxCell id="gemini-embed-methods" value="+ GetGeminiEmbedding(key, text, type) Response" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="gemini-embed" vertex="1">
          <mxGeometry y="74" width="300" height="36" as="geometry" />
        </mxCell>
        <mxCell id="database" value="&lt;&lt;Database&gt;&gt;&#xa;connection.go" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;fillColor=#f5f5f5;strokeColor=#666666;" parent="1" vertex="1">
          <mxGeometry x="1050.6" y="570" width="280" height="110" as="geometry" />
        </mxCell>
        <mxCell id="database-attr" value="+ Pool: *pgxpool.Pool" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="database" vertex="1">
          <mxGeometry y="40" width="280" height="26" as="geometry" />
        </mxCell>
        <mxCell id="database-line" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" parent="database" vertex="1">
          <mxGeometry y="66" width="280" height="8" as="geometry" />
        </mxCell>
        <mxCell id="database-methods" value="+ ConnectDB(connectionString) *Pool" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="database" vertex="1">
          <mxGeometry y="74" width="280" height="36" as="geometry" />
        </mxCell>
        <mxCell id="constants" value="&lt;&lt;Constant&gt;&gt;&#xa;chatbot_constant.go" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="1060" y="390" width="280" height="90" as="geometry" />
        </mxCell>
        <mxCell id="constants-content" value="+ ChatMessageRoleUser&#xa;+ ChatMessageRoleModel&#xa;+ Initial Prompts (V1)" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;" parent="constants" vertex="1">
          <mxGeometry y="40" width="280" height="50" as="geometry" />
        </mxCell>
        <mxCell id="rel-main-controller" value="" style="endArrow=open;endFill=0;dashed=1;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="main" target="controller" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rel-main-controller-label" value="Dependency&#xa;(initialization)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#9933FF;" parent="rel-main-controller" vertex="1" connectable="0">
          <mxGeometry x="-0.2" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-controller-service" value="" style="endArrow=open;endFill=0;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="controller" target="service" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rel-controller-service-label" value="Association&#xa;(uses service)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#0066CC;" parent="rel-controller-service" vertex="1" connectable="0">
          <mxGeometry x="-0.1" relative="1" as="geometry">
            <mxPoint y="-10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-controller-dto" value="" style="endArrow=open;endFill=0;dashed=1;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="controller" target="dto" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rel-controller-dto-label" value="Dependency&#xa;(request/response)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#9933FF;" parent="rel-controller-dto" vertex="1" connectable="0">
          <mxGeometry x="-0.2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-service-repo-session" value="" style="endArrow=open;endFill=0;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="service" target="repo-session" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rel-service-repo-session-label" value="Association&#xa;(injected via main)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#0066CC;" parent="rel-service-repo-session" vertex="1" connectable="0">
          <mxGeometry x="-0.1" relative="1" as="geometry">
            <mxPoint x="-50" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-service-repo-message" value="" style="endArrow=open;endFill=0;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="service" target="repo-message" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rel-service-repo-message-label" value="Association&#xa;(injected via main)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#0066CC;" parent="rel-service-repo-message" vertex="1" connectable="0">
          <mxGeometry x="-0.1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-service-repo-raw" value="" style="endArrow=open;endFill=0;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="service" target="repo-raw" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rel-service-repo-raw-label" value="Association&#xa;(injected via main)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#0066CC;" parent="rel-service-repo-raw" vertex="1" connectable="0">
          <mxGeometry x="-0.1" relative="1" as="geometry">
            <mxPoint x="50" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-service-embedding" value="" style="endArrow=open;endFill=0;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="service" target="repo-embedding" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rel-service-embedding-label" value="Association&#xa;(shared for RAG)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#0066CC;" parent="rel-service-embedding" vertex="1" connectable="0">
          <mxGeometry x="-0.1" relative="1" as="geometry">
            <mxPoint y="-15" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-service-gemini-chat" value="" style="endArrow=open;endFill=0;html=1;exitX=1;exitY=0.2;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="service" target="gemini-chat" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rel-service-gemini-chat-label" value="Association&#xa;(calls API)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#0066CC;" parent="rel-service-gemini-chat" vertex="1" connectable="0">
          <mxGeometry x="-0.2" relative="1" as="geometry">
            <mxPoint y="-10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-service-gemini-embed" value="" style="endArrow=open;endFill=0;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="1" source="service" target="gemini-embed" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rel-service-gemini-embed-label" value="Association&#xa;(calls API)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#0066CC;" parent="rel-service-gemini-embed" vertex="1" connectable="0">
          <mxGeometry x="-0.2" relative="1" as="geometry">
            <mxPoint x="10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-repo-session-db" value="" style="endArrow=open;endFill=0;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="repo-session" target="database" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rel-repo-session-db-label" value="Association&#xa;(uses pool)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#0066CC;" parent="rel-repo-session-db" vertex="1" connectable="0">
          <mxGeometry x="-0.1" relative="1" as="geometry">
            <mxPoint y="-10" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-repo-session-entity" value="" style="endArrow=open;endFill=0;dashed=1;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="repo-session" target="entity-session" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rel-repo-session-entity-label" value="Dependency&#xa;(returns entity)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#9933FF;" parent="rel-repo-session-entity" vertex="1" connectable="0">
          <mxGeometry x="-0.2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-repo-message-entity" value="" style="endArrow=open;endFill=0;dashed=1;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="repo-message" target="entity-message" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rel-repo-message-entity-label" value="Dependency&#xa;(returns entity)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#9933FF;" parent="rel-repo-message-entity" vertex="1" connectable="0">
          <mxGeometry x="-0.2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-repo-raw-entity" value="" style="endArrow=open;endFill=0;dashed=1;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="repo-raw" target="entity-raw" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rel-repo-raw-entity-label" value="Dependency&#xa;(returns entity)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#9933FF;" parent="rel-repo-raw-entity" vertex="1" connectable="0">
          <mxGeometry x="-0.2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-service-constants" value="" style="endArrow=open;endFill=0;dashed=1;html=1;exitX=0.3;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="service" target="constants" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rel-service-constants-label" value="Dependency&#xa;(uses constants)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#9933FF;" parent="rel-service-constants" vertex="1" connectable="0">
          <mxGeometry x="-0.2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="05bo3xEWdu79wjLuJPx1-2" value="" style="endArrow=open;endFill=0;dashed=1;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;exitX=0.501;exitY=1.003;exitDx=0;exitDy=0;exitPerimeter=0;" parent="1" source="view-main-methods" target="view-dto" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="370" y="260" as="sourcePoint" />
            <mxPoint x="380" y="75" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="05bo3xEWdu79wjLuJPx1-3" value="Dependency&lt;br&gt;(use types)" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=10;fontColor=#9933FF;" parent="05bo3xEWdu79wjLuJPx1-2" vertex="1" connectable="0">
          <mxGeometry x="-0.2" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
